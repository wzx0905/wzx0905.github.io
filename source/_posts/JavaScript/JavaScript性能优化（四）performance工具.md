---
title: JavaScript性能优化（四）performance工具
date: 2021/4/28
categories:
 - [前端,JavaScript]
---

# 为什么使用`Performance`

- `GC`的目的是为了实现内存空间的良性循环
- 良性循环的基石是合理使用
- 时刻关注才能确定是否合理
- `Performance`提供多种监控方式

# `Performance`使用步骤

- 打开浏览器输入目标网址
- 进入开发人员工具面板，选择性能
- 开启录制功能，访问具体界面
- 执行用户行为，一段时间后停止录制
- 分析界面中记录的内存信息

![](https://pic.imgdb.cn/item/60e69d8c5132923bf8249b8e.png)

# 内存问题的外在表现

- 页面出现延迟加载活经常性暂停
- 页面持续性出现糟糕的性能
- 页面的性能随时间延长越来越差

# 界定内存问题的标准

- 内存泄漏：内存使用持续升高
- 内存膨胀：在多数设备上都存在性能问题
- 频繁垃圾回收：通过内存变化图进行分析

# 监控内存的几种方式

- 浏览器任务管理器
  - 内存一列指的是原生内存，当前界面`DOM`节点所占据的内存大小
  - `JavaScript`内存一列指的是`JS`的堆，括号内的值指的是界面当中所有可达对象正在使用的内存大小
  - 任务管理器只能帮助我们查看有没有问题，并不能定位问题原因

![](https://pic.imgdb.cn/item/60e6a0655132923bf83ac7f7.png)

- `Timeline`时序图记录

![](https://pic.imgdb.cn/item/60e6a3de5132923bf8582c41.png)

- 堆快照查找分离`DOM`
  - 什么是分离`DOM`
    - 界面元素存活再`DOM`树上
    - 垃圾对象时的`DOM`节点
    - 分离状态的`DOM`节点

![](https://pic.imgdb.cn/item/60e6a5be5132923bf866cbe7.png)

- 判断是否存在频繁的垃圾回收
  - 为什么确定频繁垃圾回收
    - `GC`工作时应用程序是停止的
    - 频繁且过长的`GC`会导致应用假死
    - 用户使用中感知应用卡顿
  - 如何判断
    - `Timeline`中频繁的上升下降
    - 任务管理器中的数据频繁的增大和减小
