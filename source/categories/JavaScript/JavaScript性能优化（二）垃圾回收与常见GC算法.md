---
title: JavaScript性能优化（二）垃圾回收与常见GC算法
date: 2021/4/23
categories:
 - [前端,JavaScript]
---

# `JavaScript`中的垃圾

- `JavaScript`中的内存管理是自动的
- 对象不在引用时是垃圾
- 对象不能存根上访问到时是垃圾

# `JavaScript`中的可达对象

- 可以访问到的对象就是可达对象（引用、作用域链）
- 可达的标准就是从根出发是否能够被找到
- `JavaScript`中的根就可以理解为是全局变量对象

# `GC`算法

## `GC`定义与作用

- `GC`就是垃圾回收机制的简写

- `GC`可以找到内存中的垃圾、并释放和回收空间

## `GC`里的垃圾是什么

- 程序中不再需要使用的对象
- 程序中不能再访问到的对象

## `GC`算法是什么

- `GC`是一种机制，垃圾回收器完成具体的工作
- 工作的内容就是查找垃圾释放空间、回收空间
- 算法就是工作时查找和回收所遵循的规则

# 常见的`GC`算法

## 引用计数

- 核心思想：设置引用数，判断当前引用数是否为0
- 引用计数器
- 引用关系改变时修改引用数字
- 引用数字为0时立即回收

> 优点
>
> - 发现垃圾时立即回收
> - 最大程度减少程序暂停
>
> 缺点
>
> - 无法回收循环引用的对象
> - 资源消耗较大，时间开销大

## 标记清除

- 核心思想：分标记和清除两个阶段完成
- 遍历所有对象找标记活动对象
- 遍历所有对象清除没有标记对象
- 回收相应的空间

> 优点
>
> - 可以回收循环引用的对象
>
> 缺点
>
> - 回收后的空闲链表地址不连续，容易造成碎片化空间，浪费空间
> - 不会立即回收垃圾对象

## 标记整理

- 标记整理可以看做时标记清除的增强
- 标记阶段的操作和标记清除一致
- 清除阶段会先执行整理，移动对象位置

> 优点
>
> - 减少碎片化空间
>
> 缺点
>
> - 不会立即回收垃圾对象
> - 移动对象位置，回收效率慢

## 分代回收

- `V8`引擎垃圾回收机制
