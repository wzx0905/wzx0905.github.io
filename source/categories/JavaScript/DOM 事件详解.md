---
title: DOM 事件详解
date: 2021/9/4
categories:
 - [前端,JavaScript]
---

### 注册事件的其他方法1

- `element.addEventListener()` 方法

- 参数：
  - 第一个参数：事件类型的字符串（直接书写`"click"` ，不需要加 `on`）
  - 第二个参数：事件函数
- 同一个元素可以多次绑定事件监听，同一个事件类型可以注册多个事件函数
- 兼容性问题：不支持 `IE9` 以下的浏览器

### 注册事件的其他方法2

- `element.attachEvent()` 方法。
- 参数：
  - 第一个参数：事件类型的字符串（需要加 `on`）
  - 第二个参数：事件函数
- 同一个元素可以多次绑定事件监听，同一个事件类型可以注册多个事件函数
- 兼容性问题：只支持 `IE10` 及以下的浏览

### 注册事件的兼容写法

- 自定义一个注册事件函数
- 参数：事件源，事件类型（不加 `on`），事件函数
- `IE9` 及以上的浏览器，使用 `addEventListener` 方法
- `IE9` 以下的浏览器，使用 `attachEvent` 方法
- 判断浏览器时，不需要判断它的版本，可以检测浏览器能力
- 浏览器能力检测：将某个方法的调用作为 `if` 语句的判断条件，如果浏览器认识该方法返回 `true`，否则返回 `false`。

### 移除事件的其他方法1

- `element.removeEventListener()` 方法。
- 参数：
  - 第一个参数：事件类型的字符串（直接书写`"click"`，不需要加 `on`）
  - 第二个参数：事件函数引用名
- 注意：没有办法移除一个匿名函数，所以在注册事件时需要单独声明一个有函数名的事件函数。 
- 兼容性问题：不支持 `IE9` 以下的浏览

### 移除事件的其他方法2

- `element.detachEvent()` 方法
- 参数：
  - 第一个参数：事件类型的字符串（需要加 `on`）
  - 第二个参数：事件函数
- 注意：没有办法移除一个匿名函数，所以在注册事件时需要单独声明一个有函数名的事件函数。 
- 兼容性问题：只支持 `IE10`

### 移除事件的兼容写法

- 自定义一个移除事件函数
- 参数：事件源，事件类型（不加 `on`），事件函数
- `IE9` 及以上的浏览器，使用 `removeEventListener` 方法
- `IE9` 以下的浏览器，使用 `detachEvent` 方法
- 建议：将自己封装的一些常用函数和方法，放到一个单独的 `.js` 文件中。

### `DOM` 事件流

![](https://pic.imgdb.cn/item/61b064942ab3f51d912a77b1.png)

### 事件流的三个阶段

- 第一个阶段：事件捕获
- 第二个阶段：事件执行过程
- 第三个阶段：事件冒泡
- `addEventListener()` 第三个参数为 `false` 时，事件冒泡
- `addEventListener()` 第三个参数为 `true` 时，事件捕获
- `onclick` 类型：只能进行事件冒泡过程，没有捕获阶段
- `attachEvent()` 方法：只能进行事件冒泡过程，没有捕获阶段

### 事件委托

- 利用事件冒泡，将子级的事件委托给父级加载
- 同时，需要利用事件函数的一个 `e` 参数，内部存储的是事件对象

### 事件对象

- 只要触发事件，就会有一个对象，内部存储了与事件相关的数据。
- `e` 在低版本浏览器中有兼容问题，低版本浏览器使用的是 `window.even`
- 事件对象常用的属性：
  - `e.eventPhase` 查看事件触发时所处的阶段
  - `e.target` 用于获取触发事件的元素
  - `e.srcElement` 用于获取触发事件的元素，低版本浏览器使用
  - `e.currentTarget` 用于获取绑定事件的事件源元素
  - `e.type` 获取事件类型
  - `e.clientX`/`e.clientY` 所有浏览器都支持，鼠标距离浏览器窗口左上角的距离 
  - `e.pageX`/`e.pageY` `IE8` 以前不支持，鼠标距离整个`HTML`页面左上顶点的距离

### 取消默认行为和阻止事件传播的方式

- `e.preventDefault()` 取消默认行为
- `e.returnValue` 取消默认行为，低版本浏览器使用
- `e.stopPropagation()` 阻止冒泡，标准方式
- `e.cancelBubble = true` 阻止冒泡，`IE` 低版本，标准中已废弃

### 其他事件类型

 [MDN web 事件参考](https://developer.mozilla.org/zh-CN/docs/Web/Events)

